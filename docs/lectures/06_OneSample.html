<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dustin Haraden, PhD">

<title>PSYC 640 - Grad Stats - Categorical &amp; One-Sample</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 640 - Grad Stats</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../lectures/05_Pre-Lab.html" rel="" target="">
 <span class="dropdown-text">Week 5 - Pre-Lab</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/05_Hypothesis-Power" rel="" target="">
 <span class="dropdown-text">Week 5 - Hypotheses &amp; Power</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/06_OneSample" rel="" target="">
 <span class="dropdown-text">Week 6 - Categorical Data</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#last-week" id="toc-last-week" class="nav-link active" data-scroll-target="#last-week">Last week</a></li>
  <li><a href="#this-week" id="toc-this-week" class="nav-link" data-scroll-target="#this-week">This Week…</a>
  <ul class="collapse">
  <li><a href="#key-questions" id="toc-key-questions" class="nav-link" data-scroll-target="#key-questions">Key questions:</a></li>
  </ul></li>
  <li><a href="#what-are-the-steps-of-nhst" id="toc-what-are-the-steps-of-nhst" class="nav-link" data-scroll-target="#what-are-the-steps-of-nhst">What are the steps of NHST?</a></li>
  <li><a href="#example---coffee-shop" id="toc-example---coffee-shop" class="nav-link" data-scroll-target="#example---coffee-shop">Example - Coffee Shop</a>
  <ul class="collapse">
  <li><a href="#example---distribution" id="toc-example---distribution" class="nav-link" data-scroll-target="#example---distribution">Example - Distribution</a></li>
  <li><a href="#example---set-alpha" id="toc-example---set-alpha" class="nav-link" data-scroll-target="#example---set-alpha">Example - Set Alpha</a></li>
  <li><a href="#example---distribution-1" id="toc-example---distribution-1" class="nav-link" data-scroll-target="#example---distribution-1">Example - Distribution</a></li>
  </ul></li>
  <li><a href="#distribution---degrees-of-freedom" id="toc-distribution---degrees-of-freedom" class="nav-link" data-scroll-target="#distribution---degrees-of-freedom">Distribution - Degrees of freedom</a></li>
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of freedom</a>
  <ul class="collapse">
  <li><a href="#calculating-the-chi2-test-statistic" id="toc-calculating-the-chi2-test-statistic" class="nav-link" data-scroll-target="#calculating-the-chi2-test-statistic">Calculating the <span class="math inline">\(\chi^2\)</span> test statistic</a></li>
  <li><a href="#recap-of-the-steps" id="toc-recap-of-the-steps" class="nav-link" data-scroll-target="#recap-of-the-steps">Recap of the Steps</a></li>
  <li><a href="#recap-of-the-steps-cont." id="toc-recap-of-the-steps-cont." class="nav-link" data-scroll-target="#recap-of-the-steps-cont.">Recap of the Steps (con’t.)</a></li>
  </ul></li>
  <li><a href="#but-what-if" id="toc-but-what-if" class="nav-link" data-scroll-target="#but-what-if">But what if…</a></li>
  <li><a href="#example-2---schools-super-powers" id="toc-example-2---schools-super-powers" class="nav-link" data-scroll-target="#example-2---schools-super-powers">Example 2 - Schools &amp; Super-powers</a>
  <ul class="collapse">
  <li><a href="#calculating-the-chi2-test-statistic-1" id="toc-calculating-the-chi2-test-statistic-1" class="nav-link" data-scroll-target="#calculating-the-chi2-test-statistic-1">Calculating the <span class="math inline">\(\chi^2\)</span> test statistic</a></li>
  </ul></li>
  <li><a href="#write-up-practice" id="toc-write-up-practice" class="nav-link" data-scroll-target="#write-up-practice">Write-up Practice</a></li>
  <li><a href="#the-usefulness-of-chi2" id="toc-the-usefulness-of-chi2" class="nav-link" data-scroll-target="#the-usefulness-of-chi2">The usefulness of <span class="math inline">\(\chi^2\)</span></a></li>
  <li><a href="#model-fit-with-chi2" id="toc-model-fit-with-chi2" class="nav-link" data-scroll-target="#model-fit-with-chi2">Model Fit with <span class="math inline">\(\chi^2\)</span></a></li>
  <li><a href="#next-up" id="toc-next-up" class="nav-link" data-scroll-target="#next-up">Next up…</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="06_OneSample.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Categorical &amp; One-Sample</h1>
<p class="subtitle lead">PSYC 640 - Fall 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dustin Haraden, PhD </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="last-week" class="level2">
<h2 class="anchored" data-anchor-id="last-week">Last week</h2>
<p>NHST &amp; <em>p-</em>values</p>
<p>Lab 2…feedback?</p>
<p>Frequency of Labs check-in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychTools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="this-week" class="level2">
<h2 class="anchored" data-anchor-id="this-week">This Week…</h2>
<ul>
<li>The chi-square goodness-of-fit test</li>
<li>One-sample <em>t</em>-tests</li>
</ul>
<hr>
<section id="key-questions" class="level3">
<h3 class="anchored" data-anchor-id="key-questions">Key questions:</h3>
<ul>
<li><p>How do we know if category frequencies are consistent with null hypothesis expectations?</p></li>
<li><p>How do we handle categories with very low frequencies?</p></li>
<li><p>How do we compare one sample to a population mean?</p></li>
</ul>
<hr>
</section>
</section>
<section id="what-are-the-steps-of-nhst" class="level2">
<h2 class="anchored" data-anchor-id="what-are-the-steps-of-nhst">What are the steps of NHST?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><p>Define null and alternative hypothesis.</p></li>
<li><p>Set and justify alpha level.</p></li>
<li><p>Determine which sampling distribution ( <span class="math inline">\(z\)</span>, <span class="math inline">\(t\)</span>, or <span class="math inline">\(\chi^2\)</span> for now)</p></li>
<li><p>Calculate parameters of your sampling distribution under the null.</p></li>
</ol>
<ul>
<li>If <span class="math inline">\(z\)</span>, calculate <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma_M\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<ol start="5" type="1">
<li>Calculate test statistic under the null.</li>
</ol>
<ul>
<li>If <span class="math inline">\(z\)</span>, <span class="math inline">\(\frac{\bar{X} - \mu}{\sigma_M}\)</span></li>
</ul>
<ol start="6" type="1">
<li>Calculate probability of that test statistic or more extreme under the null, and compare to alpha.</li>
</ol>
</div>
</div>
<hr>
<p>One-sample tests compare your given sample with a “known” population.</p>
<p>Research question: does this sample come from this population?</p>
<p><strong>Hypotheses</strong></p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Yes, this sample comes from this population.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: No, this sample comes from a different population.</p></li>
</ul>
<hr>
</section>
<section id="example---coffee-shop" class="level2">
<h2 class="anchored" data-anchor-id="example---coffee-shop">Example - Coffee Shop</h2>
<p>Let’s say we collect data on customers of a coffee shop and we want to see if there is an <strong>equal number of folks</strong> that come into the shop across all days. Therefore, we record how many individuals came into the coffee shop over a weeks time.</p>
<p><strong><em>How would we test this?</em></strong></p>
<ul>
<li><p>First, setup the Null and alternative:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Customers will be equal across all days.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: There will be more customers on one or multiple days than others and will not be equal</p></li>
</ul></li>
</ul>
<hr>
<section id="example---distribution" class="level3">
<h3 class="anchored" data-anchor-id="example---distribution">Example - Distribution</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"T"</span>, <span class="st">"W"</span>, <span class="st">"R"</span>, <span class="st">"F"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">50</span>, <span class="fu">length</span>(days))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(days, expected)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"T"</span>, <span class="st">"W"</span>, <span class="st">"R"</span>, <span class="st">"F"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>unif <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> expected)) <span class="sc">+</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> order) <span class="sc">+</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Uniform - Null"</span>) <span class="sc">+</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">65</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">55</span>, <span class="at">sd =</span> <span class="dv">4</span>),<span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(days, observed)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> days, </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> observed)) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> order) <span class="sc">+</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Alternative"</span>) <span class="sc">+</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">65</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>(unif <span class="sc">+</span> rand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="example---set-alpha" class="level3">
<h3 class="anchored" data-anchor-id="example---set-alpha">Example - Set Alpha</h3>
<p>After determining the Null and Alternative Hypotheses, we set our Alpha level.</p>
<p>Let’s keep things simple and keep it at convention to set it for <span class="math inline">\(\alpha\)</span> = 0.05</p>
<hr>
</section>
<section id="example---distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="example---distribution-1">Example - Distribution</h3>
<p>Now we determine the type of distribution that we will be working with</p>
<p>In the past we have used:</p>
<ul>
<li><p>Normal Distribution ( <span class="math inline">\(z\)</span>-scores )</p></li>
<li><p>t-distribution ( <span class="math inline">\(t\)</span>-scores )</p></li>
</ul>
<hr>
<p>Now we are going to be using a distribution that works with <strong><em>categorical (nominal)</em></strong> <strong>data</strong>.</p>
<p><strong>The</strong> <span class="math inline">\(\chi^2\)</span> <strong>- distribution</strong></p>
<div class="nonincremental">
<ul>
<li><p>We use this distribution because we are dealing with (1) one sample, and (2) a categorical outcome</p></li>
<li><p><strong>Note</strong>: this test will provide statistical evidence of an association or relationship between two categorical variables</p></li>
</ul>
</div>
<p><strong><em>???</em></strong> The way you measure the variable determines whether it is categorical or continuous. We can create summary statistics from categorical variables by counting or calculating proportions – but that makes the summary statistics continuous, <em>not the outcome variable itself</em>.</p>
<hr>
</section>
</section>
<section id="distribution---degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="distribution---degrees-of-freedom">Distribution - Degrees of freedom</h2>
<p>The <span class="math inline">\(\chi^2\)</span> distribution is a single-parameter distribution defined by it’s degrees of freedom.</p>
<p>In the case of a <strong>goodness-of-fit test</strong> (like this one), the degrees of freedom are <span class="math inline">\(\textbf{k-1}\)</span>, where k is the number of groups.</p>
<hr>
</section>
<section id="degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of freedom</h2>
<p>The <strong>Degrees of freedom</strong> are the number of genuinely independent things in a calculation. It’s specifically calculated as the number of quantities in a calculation minus the number of constraints.</p>
<p>What it means in principle is that given a set number of categories (k) and a constraint (the proportions have to add up to 1), I can freely choose numbers for k-1 categories. But for the kth category, there’s only one number that will work.</p>
<hr>
<div class="columns">
<div class="column" style="width:30%;">
<p><span style="font-size:30px;">The degrees of freedom are the number of categories (k) minus 1. Given that the category frequencies must sum to the total sample size, k-1 category frequencies are free to vary; the last is determined.</span></p>
</div><div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">critical_val =</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">df =</span> <span class="dv">5-1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.487729</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">5-1</span>), <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">5-1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span><span class="fu">c</span>(critical_val, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> critical_val), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> critical_val<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="dv">5-1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Critical Value ="</span>, <span class="fu">round</span> (critical_val,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chi-Square"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Area under the curve"</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<hr>
<section id="calculating-the-chi2-test-statistic" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-chi2-test-statistic">Calculating the <span class="math inline">\(\chi^2\)</span> test statistic</h3>
<p>Let’s first take a look at the observed data that we have as well as the expected data under the Null</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> df2</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td><strong>Monday</strong></td>
<td><strong>Tuesday</strong></td>
<td><strong>Wednesday</strong></td>
<td><strong>Thursday</strong></td>
<td><strong>Friday</strong></td>
</tr>
<tr class="even">
<td><strong>Observed</strong></td>
<td><span class="math inline">\(O_i\)</span></td>
<td>60.48</td>
<td>52.74</td>
<td>56.45</td>
<td>57.53</td>
<td>56.62</td>
</tr>
<tr class="odd">
<td><strong>Expected</strong></td>
<td><span class="math inline">\(E_i\)</span></td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
</tr>
</tbody>
</table>
<p>Now what? We need some way to index differences between these frequencies so that we can sensibly determine how rare or unusual the observed data are compared to the null distribution.</p>
<hr>
<p><span class="math display">\[\chi^2_{df = k-1} = \sum^k_{i=1}\frac{(O_i-E_i)^2}{E_i}\]</span></p>
<p>The chi-square goodness of fit (GOF) statistic compares observed and expected frequencies. It is small when the observed frequencies closely match the expected frequencies under the null hypothesis. The chi-square distribution can be used to determine the particular <span class="math inline">\(\chi^2\)</span> value that corresponds to a rare or unusual profile of observed frequencies.</p>
<hr>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td><strong>Monday</strong></td>
<td><strong>Tuesday</strong></td>
<td><strong>Wednesday</strong></td>
<td><strong>Thursday</strong></td>
<td><strong>Friday</strong></td>
</tr>
<tr class="even">
<td><strong>Observed</strong></td>
<td><span class="math inline">\(O_i\)</span></td>
<td>60.48</td>
<td>52.74</td>
<td>56.45</td>
<td>57.53</td>
<td>56.62</td>
</tr>
<tr class="odd">
<td><strong>Expected</strong></td>
<td><span class="math inline">\(E_i\)</span></td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
<td>50</td>
</tr>
<tr class="even">
<td><strong>Difference</strong></td>
<td><span class="math inline">\(O_i - E_i\)</span></td>
<td>10.48</td>
<td>2.74</td>
<td>6.45</td>
<td>7.53</td>
<td>6.62</td>
</tr>
</tbody>
</table>
<hr>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>chisq_tab <span class="ot">&lt;-</span> <span class="fu">full_join</span>(expected, observed) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (observed <span class="sc">-</span> expected))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>chisq_tab <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(., <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>), </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Days"</span>, <span class="st">"Expected"</span>, <span class="st">"Observed"</span>, <span class="st">"Difference"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Days</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expected</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Observed</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">M</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">60.48</td>
<td style="text-align: center;">10.48</td>
</tr>
<tr class="even">
<td style="text-align: center;">T</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">52.74</td>
<td style="text-align: center;">2.74</td>
</tr>
<tr class="odd">
<td style="text-align: center;">W</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.45</td>
<td style="text-align: center;">6.45</td>
</tr>
<tr class="even">
<td style="text-align: center;">R</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">57.53</td>
<td style="text-align: center;">7.53</td>
</tr>
<tr class="odd">
<td style="text-align: center;">F</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.62</td>
<td style="text-align: center;">6.62</td>
</tr>
</tbody>
</table>


</div>
<hr>
<p>We now have the differences between the expected and observed, but there are likely going to be some negative numbers. To fix this, we can square the differences</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>chisq_tab <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sq_diff=</span>(diff<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(., <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Days"</span>, <span class="st">"Expected"</span>, <span class="st">"Observed"</span>, <span class="st">"Difference"</span>, <span class="st">"Sq. Diff"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Days</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expected</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Observed</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Difference</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Sq. Diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">M</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">60.48</td>
<td style="text-align: center;">10.48</td>
<td style="text-align: center;">109.83</td>
</tr>
<tr class="even">
<td style="text-align: center;">T</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">52.74</td>
<td style="text-align: center;">2.74</td>
<td style="text-align: center;">7.51</td>
</tr>
<tr class="odd">
<td style="text-align: center;">W</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.45</td>
<td style="text-align: center;">6.45</td>
<td style="text-align: center;">41.60</td>
</tr>
<tr class="even">
<td style="text-align: center;">R</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">57.53</td>
<td style="text-align: center;">7.53</td>
<td style="text-align: center;">56.70</td>
</tr>
<tr class="odd">
<td style="text-align: center;">F</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.62</td>
<td style="text-align: center;">6.62</td>
<td style="text-align: center;">43.82</td>
</tr>
</tbody>
</table>


</div>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<p>Now we have a collection of numbers that are large whenever the null hypothesis makes a bad prediction and small when it makes a good prediction.</p>
<p>Next, we need to divide all numbers by the expected frequency as a way to put our estimate into perspective</p>
</div><div class="column" style="width:50%;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>chisq_tab <span class="ot">&lt;-</span> chisq_tab <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sq_diff=</span>(diff<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> sq_diff<span class="sc">/</span><span class="dv">50</span>) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>chisq_tab <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(., <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>), </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Days"</span>, <span class="st">"Expected"</span>, <span class="st">"Observed"</span>, <span class="st">"Difference"</span>, <span class="st">"Sq. Diff"</span>, <span class="st">"Error Score"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Days</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expected</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Observed</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Difference</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Sq. Diff</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Error Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">M</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">60.48</td>
<td style="text-align: center;">10.48</td>
<td style="text-align: center;">109.83</td>
<td style="text-align: center;">2.20</td>
</tr>
<tr class="even">
<td style="text-align: center;">T</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">52.74</td>
<td style="text-align: center;">2.74</td>
<td style="text-align: center;">7.51</td>
<td style="text-align: center;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">W</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.45</td>
<td style="text-align: center;">6.45</td>
<td style="text-align: center;">41.60</td>
<td style="text-align: center;">0.83</td>
</tr>
<tr class="even">
<td style="text-align: center;">R</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">57.53</td>
<td style="text-align: center;">7.53</td>
<td style="text-align: center;">56.70</td>
<td style="text-align: center;">1.13</td>
</tr>
<tr class="odd">
<td style="text-align: center;">F</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">56.62</td>
<td style="text-align: center;">6.62</td>
<td style="text-align: center;">43.82</td>
<td style="text-align: center;">0.88</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<hr>
<p>We can finish this off by taking each of our scores related to “error” and adding them up</p>
<p>The result is the <strong>goodness of fit</strong> statistic (GOF) or <span class="math inline">\(\chi^2\)</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>chi_square <span class="ot">&lt;-</span> <span class="fu">sum</span>(chisq_tab<span class="sc">$</span>error)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>chi_square</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.189316</code></pre>
</div>
</div>
<p>Let’s compare that to the critical <span class="math inline">\(\chi^2\)</span> value given the df of the sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>critical_val <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>critical_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.487729</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Calculate the probability of getting our sample statistic or greater <strong><em>if the null were true</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(<span class="at">q =</span> chi_square, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2684182</code></pre>
</div>
</div>
<p><strong>What can we conclude?</strong></p>
</div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:30%;">
<p><span style="font-size:30px;">The degrees of freedom are the number of categories (k) minus 1. Given that the category frequencies must sum to the total sample size, k-1 category frequencies are free to vary; the last is determined.</span></p>
</div><div class="column" style="width:70%;">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span><span class="fu">c</span>(critical_val, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> critical_val), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> chi_square), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> critical_val<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Critical Value ="</span>, <span class="fu">round</span> (critical_val,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> chi_square<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Test statistic ="</span>, <span class="fu">round</span> (chi_square,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chi-Square"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Area under the curve"</span>) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:30%;">
<p><span style="font-size:30px;">The degrees of freedom are the number of categories (k) minus 1. Given that the category frequencies must sum to the total sample size, k-1 category frequencies are free to vary; the last is determined.</span></p>
</div><div class="column" style="width:70%;">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span><span class="fu">c</span>(chi_square, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> critical_val), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> chi_square), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> critical_val<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Critical Value ="</span>, <span class="fu">round</span> (critical_val,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> chi_square<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Test statistic ="</span>, <span class="fu">round</span> (chi_square,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chi-Square"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Area under the curve"</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="recap-of-the-steps" class="level3">
<h3 class="anchored" data-anchor-id="recap-of-the-steps">Recap of the Steps</h3>
<ol type="1">
<li>Define null and alternative hypothesis.</li>
</ol>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: No difference across days</p></li>
<li><p><span class="math inline">\(H_1\)</span>: Days will be different</p></li>
</ul>
<ol start="2" type="1">
<li><p>Set and justify alpha level <span class="math inline">\(\alpha\)</span> = 0.05</p></li>
<li><p>Determine which sampling distribution ( <span class="math inline">\(\chi^2\)</span> )</p></li>
<li><p>Calculate parameters of your sampling distribution under the null.</p></li>
</ol>
<ul>
<li>Calculate <span class="math inline">\(\chi^2\)</span>-critical: 9.487729</li>
</ul>
</section>
<section id="recap-of-the-steps-cont." class="level3">
<h3 class="anchored" data-anchor-id="recap-of-the-steps-cont.">Recap of the Steps (con’t.)</h3>
<ol start="5" type="1">
<li>Calculate test statistic under the null.</li>
</ol>
<ul>
<li><span class="math inline">\(\chi^2_{df = k-1} = \sum^k_{i=1}\frac{(O_i-E_i)^2}{E_i}\)</span></li>
<li>5.189316</li>
</ul>
<ol start="6" type="1">
<li><p>Calculate probability of that test statistic or more extreme under the null, and compare to alpha.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> chi_square, <span class="at">df =</span> <span class="fu">length</span>(chisq_tab<span class="sc">$</span>days)<span class="sc">-</span><span class="dv">1</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2684182</code></pre>
</div>
</div></li>
</ol>
<hr>
<p>Now that we know how to do the test using R, we now need to be able to <strong><em>write up the analyses</em></strong> that we just performed.</p>
<p>If we wanted to write these results from our example into a paper or something similar (maybe telling our pet who prefers scientific writing), we could do this:</p>
<blockquote class="blockquote">
<p>Across all days of the average workweek, we observed, 60.48 patrons on Monday, 52.74 customers on Tuesday, 56.45 on Wednesday, 57.53 for Thursday, and finally 56.62 patrons on Friday. A chi-square goodness of fit test was conducted to test whether these data followed a uniform distribution with 50 visits per day. The results of the test ( <span class="math inline">\(\chi^2\)</span>(4) = 5.19, <span class="math inline">\(p\)</span> = 0.27) indicate no differences from the uniform distribution.</p>
</blockquote>
<hr>
<blockquote class="blockquote">
<p>Across all days of the average workweek, we observed, 60.48 patrons on Monday, 52.74 customers on Tuesday, 56.45 on Wednesday, 57.53 for Thursday, and finally 56.62 patrons on Friday. A chi-square goodness of fit test was conducted to test whether these data followed a uniform distribution with 50 visits per day. The results of the test ( <span class="math inline">\(\chi^2\)</span>(4) = 5.19, <span class="math inline">\(p\)</span> = 0.27) indicate no differences from the uniform distribution.</p>
</blockquote>
<p>A couple things to notice about the write up:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><p>Before the test, there are some descriptives</p></li>
<li><p>Informs you of the null hypothesis</p></li>
</ol>
</div><div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Inclusion of a “stats block”</li>
<li>Results are interpreted</li>
</ol>
</div>
</div>
</section>
</section>
<section id="but-what-if" class="level2">
<h2 class="anchored" data-anchor-id="but-what-if">But what if…</h2>
<p>In the example, we had a null distribution that was distributed uniformly</p>
<p>What if that isn’t a super interesting research question?</p>
<p>Instead we may want to compare the proportions in our sample to a larger population</p>
</section>
<section id="example-2---schools-super-powers" class="level2">
<h2 class="anchored" data-anchor-id="example-2---schools-super-powers">Example 2 - Schools &amp; Super-powers</h2>
<p>The data were obtained from <a href="https://ww2.amstat.org/censusatschool/">Census at School</a>, a website developed by the American Statistical Association tohelp students in the 4th through 12th grades understand statistical problem-solving.</p>
<div class="nonincremental">
<ul>
<li><p>The site sponsors a survey that students can complete and a database that students and instructors can use to illustrate principles in quantitative methods.</p></li>
<li><p>The database includes students from all 50 states, from grade levels 4 through 12, both boys and girls, who have completed the survey dating back to 2010.</p></li>
</ul>
</div>
<hr>
<p>Let’s focus on a single question:</p>
<p><em>Which of the following superpowers would you most like to have? Select one.</em></p>
<div class="nonincremental">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Invisibility</li>
<li>Telepathy (read minds)</li>
<li>Freeze time</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Super strength</li>
<li>Fly</li>
</ul>
</div>
</div>
</div>
<p>The responses from 250 randomly selected New York students were obtained from the Census at School database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/dharaden/dharaden.github.io/main/data/example2-chisq.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Superpower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>school <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Superpower) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Frequency<span class="sc">/</span><span class="fu">sum</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(., </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">font_size =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Superpower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Frequency</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fly</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Freeze time</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Invisibility</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Super strength</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Telepathy</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0.33</td>
</tr>
</tbody>
</table>


</div>
</div><div class="column" style="width:50%;">
<p>Descriptively this is interesting. But, are the responses unusual or atypical in any way? To answer that question, we need some basis for comparison—a null hypothesis <br> One option would be to ask if the New York preferences are different compared to students from the general population.</p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>school_usa <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/uopsych/psy611/master/data/census_at_school_usa.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>school_usa<span class="sc">$</span>Region <span class="ot">=</span> <span class="st">"USA"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>school <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">select</span>(school_usa, Region, Superpower)) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Superpower)) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Superpower) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Frequency<span class="sc">/</span><span class="fu">sum</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Region, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Category Proportion as a function of Source"</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Superpower) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span> </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math inline">\(H_0\)</span>: New York student superpower preferences are similar to the preferences of typical students in the United States.</p>
<p><span class="math inline">\(H_1\)</span>: New York student superpower preferences are different from the preferences of typical students in the United States.</p>
</div><div class="column" style="width:50%;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>school <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">select</span>(school_usa, Region, Superpower)) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="fu">ifelse</span>(Region <span class="sc">==</span> <span class="st">"NY"</span>, <span class="st">"NY"</span>, <span class="st">"USA"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Superpower)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Superpower) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Frequency<span class="sc">/</span><span class="fu">sum</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Frequency) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(Region, Proportion) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(., </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Superpower"</span>, <span class="st">"NY Observed</span><span class="sc">\n</span><span class="st">Proportion"</span>, </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"USA</span><span class="sc">\n</span><span class="st">Proportion"</span>), </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">font_size =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Superpower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NY Observed Proportion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">USA Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fly</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Freeze time</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Invisibility</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Super strength</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Telepathy</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.24</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<hr>
<section id="calculating-the-chi2-test-statistic-1" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-chi2-test-statistic-1">Calculating the <span class="math inline">\(\chi^2\)</span> test statistic</h3>
<p>To compare the New York observed frequencies to the US data, we need to calculate the frequencies that would have been expected if New York was just like all of the other states.</p>
<p>The expected frequencies under this null model can be obtained by taking each preference category proportion from the US data (the null expectation) and multiplying it by the sample size for New York:</p>
<p><span class="math display">\[E_i = P_iN_{NY}\]</span></p>
<hr>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Superpower</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Observed Freq</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Expected Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fly</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">46.91</td>
</tr>
<tr class="even">
<td style="text-align: left;">Freeze time</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">50.37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Invisibility</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">39.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">Super strength</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">15.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Telepathy</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">47.41</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Now what? We need some way to index differences between these frequencies, preferably one that translates easily into a sampling distribution so that we can sensibly determine how rare or unusual the New York data are compared to the US (null) distribution.</p>
<hr>
<p><span class="math display">\[\chi^2_{df = k-1} = \sum^k_{i=1}\frac{(O_i-E_i)^2}{E_i}\]</span></p>
<p>The chi-square goodness of fit (GOF) statistic compares observed and expected frequencies. It is small when the observed frequencies closely match the expected frequencies under the null hypothesis. The chi-square distribution can be used to determine the particular <span class="math inline">\(\chi^2\)</span> value that corresponds to a rare or unusual profile of observed frequencies.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ny_observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
            39             62             25             13             67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ny_expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
      46.91358       50.37037       39.50617       15.80247       47.40741 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ny_observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
            39             62             25             13             67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ny_expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
      46.91358       50.37037       39.50617       15.80247       47.40741 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">chi_square =</span> <span class="fu">sum</span>((ny_observed <span class="sc">-</span> ny_expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>ny_expected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.94071</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ny_observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
            39             62             25             13             67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ny_expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
      46.91358       50.37037       39.50617       15.80247       47.40741 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">chi_square =</span> <span class="fu">sum</span>((ny_observed <span class="sc">-</span> ny_expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>ny_expected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.94071</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">critical_val =</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.487729</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ny_observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
            39             62             25             13             67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ny_expected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
      46.91358       50.37037       39.50617       15.80247       47.40741 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">chi_square =</span> <span class="fu">sum</span>((ny_observed <span class="sc">-</span> ny_expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>ny_expected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.94071</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">critical_val =</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.487729</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">p_val =</span> <span class="fu">pchisq</span>(<span class="at">q =</span> chi_square, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>, <span class="at">lower.tail =</span> F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001267462</code></pre>
</div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:30%;">
<p><span style="font-size:30px;">The degrees of freedom are the number of categories (k) minus 1. Given that the category frequencies must sum to the total sample size, k-1 category frequencies are free to vary; the last is determined.</span></p>
</div><div class="column" style="width:70%;">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span><span class="fu">c</span>(critical_val, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> critical_val), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> chi_square), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> critical_val<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Critical Value ="</span>, <span class="fu">round</span> (critical_val,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> chi_square<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Test statistic ="</span>, <span class="fu">round</span> (chi_square,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chi-Square"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Area under the curve"</span>) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<hr>
<div class="columns">
<div class="column" style="width:30%;">
<p><span style="font-size:30px;">The degrees of freedom are the number of categories (k) minus 1. Given that the category frequencies must sum to the total sample size, k-1 category frequencies are free to vary; the last is determined.</span></p>
</div><div class="column" style="width:70%;">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span><span class="fu">c</span>(chi_square, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> critical_val), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> chi_square), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> critical_val<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Critical Value ="</span>, <span class="fu">round</span> (critical_val,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> chi_square<span class="sc">+</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">dchisq</span>(critical_val, <span class="fu">length</span>(ny_expected)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> .<span class="dv">05</span>, </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Test statistic ="</span>, <span class="fu">round</span> (chi_square,<span class="dv">2</span>))), <span class="at">angle =</span> <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Chi-Square"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Area under the curve"</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="06_OneSample_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>p.usa <span class="ot">=</span> (<span class="fu">table</span>(school_usa<span class="sc">$</span>Superpower)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">table</span>(school_usa<span class="sc">$</span>Superpower)))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>p.usa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
    0.23456790     0.25185185     0.19753086     0.07901235     0.23703704 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> ny_observed, <span class="at">p =</span> p.usa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  ny_observed
X-squared = 17.243, df = 4, p-value = 0.001733</code></pre>
</div>
</div>
<p>The New York student preferences are unusual under the null hypothesis (USA preferences).</p>
<p>Note that the <code>chisq.test</code> function takes for x a vector of the counts. In other words, to use this function, you need to calculate the summary statisttic of counts and feed that into the function.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>c.test <span class="ot">=</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> ny_observed, <span class="at">p =</span> p.usa)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(c.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 9
 $ statistic: Named num 17.2
  ..- attr(*, "names")= chr "X-squared"
 $ parameter: Named num 4
  ..- attr(*, "names")= chr "df"
 $ p.value  : num 0.00173
 $ method   : chr "Chi-squared test for given probabilities"
 $ data.name: chr "ny_observed"
 $ observed : 'table' int [1:5(1d)] 39 62 25 13 67
  ..- attr(*, "dimnames")=List of 1
  .. ..$ : chr [1:5] "Fly" "Freeze time" "Invisibility" "Super strength" ...
 $ expected : 'table' num [1:5(1d)] 48.3 51.9 40.7 16.3 48.8
  ..- attr(*, "dimnames")=List of 1
  .. ..$ : chr [1:5] "Fly" "Freeze time" "Invisibility" "Super strength" ...
 $ residuals: 'table' num [1:5(1d)] -1.341 1.405 -2.46 -0.812 2.6
  ..- attr(*, "dimnames")=List of 1
  .. ..$ : chr [1:5] "Fly" "Freeze time" "Invisibility" "Super strength" ...
 $ stdres   : 'table' num [1:5(1d)] -1.533 1.624 -2.746 -0.846 2.977
  ..- attr(*, "dimnames")=List of 1
  .. ..$ : chr [1:5] "Fly" "Freeze time" "Invisibility" "Super strength" ...
 - attr(*, "class")= chr "htest"</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>c.test<span class="sc">$</span>residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Fly    Freeze time   Invisibility Super strength      Telepathy 
    -1.3408927      1.4047879     -2.4598546     -0.8121473      2.6002917 </code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">goodnessOfFitTest</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(school<span class="sc">$</span>Superpower), <span class="at">p =</span> p.usa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Chi-square test against specified probabilities

Data variable:   as.factor(school$Superpower) 

Hypotheses: 
   null:        true probabilities are as specified
   alternative: true probabilities differ from those specified

Descriptives: 
               observed freq. expected freq. specified prob.
Fly                        39       48.32099      0.23456790
Freeze time                62       51.88148      0.25185185
Invisibility               25       40.69136      0.19753086
Super strength             13       16.27654      0.07901235
Telepathy                  67       48.82963      0.23703704

Test results: 
   X-squared statistic:  17.243 
   degrees of freedom:  4 
   p-value:  0.002 </code></pre>
</div>
</div>
<p>(Note that this function, <code>goodnessOfFitTest</code>, takes the raw data, not the vector of counts.)</p>
<hr>
<p>What if we had used the equal proportions null hypothesis?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">goodnessOfFitTest</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(school<span class="sc">$</span>Superpower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Chi-square test against specified probabilities

Data variable:   as.factor(school$Superpower) 

Hypotheses: 
   null:        true probabilities are as specified
   alternative: true probabilities differ from those specified

Descriptives: 
               observed freq. expected freq. specified prob.
Fly                        39           41.2             0.2
Freeze time                62           41.2             0.2
Invisibility               25           41.2             0.2
Super strength             13           41.2             0.2
Telepathy                  67           41.2             0.2

Test results: 
   X-squared statistic:  52.447 
   degrees of freedom:  4 
   p-value:  &lt;.001 </code></pre>
</div>
</div>
<p>Why might this be a sensible or useful test?</p>
</section>
</section>
<section id="write-up-practice" class="level2">
<h2 class="anchored" data-anchor-id="write-up-practice">Write-up Practice</h2>
<p>Open up a word document and provide a 2-6 sentence write up of the analyses that we just completed</p>
<p>Don’t forget:</p>
<ol type="1">
<li><p>Before the test, there are some descriptives</p></li>
<li><p>Information about the the null hypothesis</p></li>
<li><p>Including a “stats block”</p></li>
<li><p>Brief interpretation of the results</p></li>
</ol>
</section>
<section id="the-usefulness-of-chi2" class="level2">
<h2 class="anchored" data-anchor-id="the-usefulness-of-chi2">The usefulness of <span class="math inline">\(\chi^2\)</span></h2>
<p>How often will you conducted a <span class="math inline">\(chi^2\)</span> goodness of fit test on raw data?</p>
<ul>
<li>(Probably) never</li>
</ul>
<p>How often will you come across <span class="math inline">\(\chi^2\)</span> tests?</p>
<ul>
<li>(Probably) a lot!</li>
</ul>
<p>The goodness of fit test is used to statistically test the how well a model fits data.</p>
<hr>
</section>
<section id="model-fit-with-chi2" class="level2">
<h2 class="anchored" data-anchor-id="model-fit-with-chi2">Model Fit with <span class="math inline">\(\chi^2\)</span></h2>
<p>To calculate Goodness of Fit of a model to data, you build a statistical model of the process as you believe it is in the world.</p>
<div class="nonincremental">
<ul>
<li>example: depression ~ age + parental history of depression</li>
</ul>
</div>
<ul>
<li><p>Then you estimate each subject’s predicted/expected value based on your model.</p></li>
<li><p>You compare each subject’s predicted value to their actual value – the difference is called the <strong>residual</strong> ( <span class="math inline">\(\varepsilon\)</span> ).</p></li>
</ul>
<hr>
<p>If your model is a good fit, then</p>
<p><span class="math display">\[\Sigma_1^N\varepsilon^2 = \chi^2\]</span></p>
<ul>
<li><p>We would then compare that to the distribution of the Null: <span class="math inline">\(\chi^2_{N-p}\)</span> .</p></li>
<li><p>Significant chi-square tests suggest the model does not fit – the data have values that are far away from “expected.”</p></li>
</ul>
<hr>
<p>When we move from categorical outcomes to variables measured on an interval or ratio scale, we become interested in means rather than frequencies. Comparing means is usually done with the <em>t</em>-test, of which there are several forms.</p>
<p>The one-sample <em>t</em>-test is appropriate when a single sample mean is compared to a population mean but the population standard deviation is unknown. A sample estimate of the population standard deviation is used instead. The appropriate sampling distribution is the t-distribution, with N-1 degrees of freedom.</p>
<p><span class="math display">\[t_{df=N-1} = \frac{\bar{X}-\mu}{\frac{\hat{\sigma}}{\sqrt{N}}}\]</span></p>
<p>The heavier tails of the t-distribution, especially for small N, are the penalty we pay for having to estimate the population standard deviation from the sample.</p>
<hr>
</section>
<section id="next-up" class="level1">
<h1>Next up…</h1>
<p>Further dive into categorical data analysis</p>
<p>Starting with t-tests</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>