{
  "hash": "d48f4ae37cacc5119700197110ee5d93",
  "result": {
    "markdown": "---\ntitle: \"Categorical Data & Comparing Means\"\nsubtitle: \"PSYC 640 - Fall 2023\"\nauthor: \"Dustin Haraden, PhD\"\nformat: \n  revealjs:\n    multiplex: true\n    slide-number: true\n    incremental: true\n    touch: true\n    code-overflow: wrap\n    theme: dark\nexecute: \n  echo: true\neditor: visual\n---\n\n\n\n\n## Last week\n\n::: nonincremental\n-   Review of the NHST\n-   Categorical Data analysis with the $\\chi^2$ distribution\n    -   Goodness of Fit test\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# File management\nlibrary(here)\n# for dplyr, ggplot\nlibrary(tidyverse)\n# Descriptives\nlibrary(psych)\n# Making things look nice\nlibrary(knitr)\n# Presenting nice tables\nlibrary(kableExtra)\n# Making things look nice\nlibrary(ggpubr)\n# animate things\nlibrary(gganimate)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Today...\n\n-   The chi-square test of independence ([Book Chapter 12.2](https://learningstatisticswithr.com/book/chisquare.html#chisqindependence))\n-   Review Assumptions of chi-square test\n-   Introduction to Comparing Means\n\n------------------------------------------------------------------------\n\n## Pop Quiz...jk {.center}\n\n-   What do we mean when we say a study was powered to an effect of 0.34?\n\n-   What does a p-value tell us?\n\n    -   [Scientists get it wrong](https://fivethirtyeight.com/features/not-even-scientists-can-easily-explain-p-values/)\n\n------------------------------------------------------------------------\n\n### $\\chi^2$ test of independence or association\n\nThe previous tests that we conducted last class, we were focused on the way our data (NY Students Superpower Preferences) \"fit\" to the data of an expected distribution (US Student Superpower Preferences)\n\nAlthough this could be interesting, sometimes we have two categorical variables that we want to compare to one another\n\n-   How do types of traffic stops differ by the gender identity of the police officer?\n\n------------------------------------------------------------------------\n\nLet's take a look at a scenario:\n\nWe are part of a delivery company called Planet Express\n\n![](/images/Planet_express.webp){fig-align=\"center\" width=\"192\"}\n\n------------------------------------------------------------------------\n\nLet's take a look at a scenario:\n\nWe are part of a delivery company called Planet Express\n\nWe have been tasked to deliver a package to Chapek 9\n\n![](/images/Chapek_9.webp){fig-align=\"center\" width=\"192\"}\n\n------------------------------------------------------------------------\n\nLet's take a look at a scenario:\n\nWe are part of a delivery company called Planet Express\n\nWe have been tasked to deliver a package to Chapek 9\n\nUnfortunately, the planet is inhabited completely by robots and humans are not allowed\n\nIn order to deliver the package, we have to go through the guard gate and prove that we are able to gain access\n\n------------------------------------------------------------------------\n\n### At the guard gate\n\n> *(Robot Voice)*\n>\n> WHICH OF THE FOLLOWING WOULD YOU MOST PREFER?\n>\n> A: A Puppy\n>\n> B: A pretty flower from your sweetie\n>\n> C: A large properly-formatted data file\n>\n> CHOOSE NOW!\n\n-   Clearly an ingenious test that will catch any imposters!\n-   ***But what if humans and robots have similar preferences?***\n\n------------------------------------------------------------------------\n\nLuckily, I have connections with Chapek 9 and we can see if there are any similarities between the responses.\n\nLet's work through how to do a $\\chi^2$ test of independence (or association)\n\nFirst, we have to load in the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchapek9 <- read.csv(\"https://raw.githubusercontent.com/dharaden/dharaden.github.io/main/courses/PSYC640_fall23/data/chapek9.csv\") %>% \n  mutate(choice = as.factor(choice), \n         species = as.factor(species))\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Chapek 9 Data\n\nTake a peek at the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(chapek9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  species choice\n1   robot flower\n2   human   data\n3   human   data\n4   human   data\n5   robot   data\n6   human flower\n```\n:::\n\n```{.r .cell-code}\n# or \n#glimpse(chapek9)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n### Chapek 9 Data\n\nLook at the summary stats for the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(chapek9) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  species      choice   \n human:93   data  :109  \n robot:87   flower: 43  \n            puppy : 28  \n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Chapek 9 Data - Cross Tabs\n\nThere are a few different ways to look at these tables. We can use `xtabs()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchapekFreq <- xtabs( ~ choice + species, data = chapek9)\nchapekFreq\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        species\nchoice   human robot\n  data      65    44\n  flower    13    30\n  puppy     15    13\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Constructing Hypotheses\n\nResearch hypothesis states that \"humans and robots answer the question in different ways\"\n\nNow our notation has two subscript values?? What torture is this??\n\n![](/images/Greek_breakdown.PNG){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Constructing Hypotheses\n\nOnce we have this established, we can take a look at the null\n\n![](/images/Null_prob.PNG){fig-align=\"center\"}\n\n-   Claiming now that the true choice probabilities don't depend on the species making the choice ( $P_i$ )\n\n-   However, we don't know what the ***expected*** probability would be for each answer choice\n\n    -   We have to calculate the totals of each row/column\n\n------------------------------------------------------------------------\n\n### Chapek 9 Data - Cross Tabs\n\n::: columns\n::: {.column width=\"50%\"}\nLet's use R to make the table look fancy and calculate the totals for us!\n\nWe will use the library `sjPlot` ([link](https://strengejacke.github.io/sjPlot/reference/index.html#descriptive-statistics-tables))\n\n**Note:** Will need to knit the document to get this table\n\n\n::: {.cell codefold='true'}\n\n```{.r .cell-code}\nlibrary(sjPlot)\n\ntab_xtab(var.row = chapek9$choice, \n          var.col = chapek9$species, \n         title = \"Chapek 9 Frequencies\")\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<caption style=\"font-weight: bold; text-align:left;\">Chapek 9 Frequencies</caption>\n <tr>\n <th style=\"border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;\" rowspan=\"2\">choice</th>\n <th style=\"border-top:double; text-align:center; font-style:italic; font-weight:normal;\" colspan=\"2\">species</th>\n <th style=\"border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; \" rowspan=\"2\">Total</th>\n </tr>\n \n<tr>\n <td style=\"border-bottom:1px solid; text-align:center; padding:0.2cm;\">human</td>\n <td style=\"border-bottom:1px solid; text-align:center; padding:0.2cm;\">robot</td>\n </tr>\n \n<tr> \n<td style=\"padding:0.2cm;  text-align:left; vertical-align:middle;\">data</td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">65</span></td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">44</span></td>\n<td style=\"padding:0.2cm; text-align:center;  \"><span style=\"color:black;\">109</span></td> \n</tr>\n \n<tr> \n<td style=\"padding:0.2cm;  text-align:left; vertical-align:middle;\">flower</td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">13</span></td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">30</span></td>\n<td style=\"padding:0.2cm; text-align:center;  \"><span style=\"color:black;\">43</span></td> \n</tr>\n \n<tr> \n<td style=\"padding:0.2cm;  text-align:left; vertical-align:middle;\">puppy</td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">15</span></td>\n<td style=\"padding:0.2cm; text-align:center; \"><span style=\"color:black;\">13</span></td>\n<td style=\"padding:0.2cm; text-align:center;  \"><span style=\"color:black;\">28</span></td> \n</tr>\n \n<tr> \n<td style=\"padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;\">Total</td>\n<td style=\"padding:0.2cm; text-align:center;   border-bottom:double;\"><span style=\"color:black;\">93</span></td>\n<td style=\"padding:0.2cm; text-align:center;   border-bottom:double;\"><span style=\"color:black;\">87</span></td>\n<td style=\"padding:0.2cm; text-align:center;   border-bottom:double;\"><span style=\"color:black;\">180</span></td> \n</tr>\n<td style=\"text-align:right; font-size:0.9em; font-style:italic; padding:0.2cm;\" colspan=\"4\">&chi;<sup>2</sup>=10.722 &middot; df=2 &middot; Cramer's V=0.244 &middot; p=0.005</td> \n</tr>\n \n</table>\n`````\n:::\n\n:::\n:::\n\n------------------------------------------------------------------------\n\n### Note about degrees of freedom\n\nDegrees of freedom comes from the number of data points that you have, minus the number of constraints\n\n-   Using contingency tables (or cross-tabs), the data points we have are $rows * columns$\n\n-   There will be two constraints and $df = (rows-1) * (columns-1)$\n\n------------------------------------------------------------------------\n\nWe now have all the pieces for a $classic$ Null Hypothesis Significance Test\n\nBut we have these computers, so why not use them?\n\nUsing the `associationTest()` from the `lsr` library\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsr::associationTest(formula = ~choice+species,\n                data = chapek9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Chi-square test of categorical association\n\nVariables:   choice, species \n\nHypotheses: \n   null:        variables are independent of one another\n   alternative: some contingency exists between variables\n\nObserved contingency table:\n        species\nchoice   human robot\n  data      65    44\n  flower    13    30\n  puppy     15    13\n\nExpected contingency table under the null hypothesis:\n        species\nchoice   human robot\n  data    56.3  52.7\n  flower  22.2  20.8\n  puppy   14.5  13.5\n\nTest results: \n   X-squared statistic:  10.722 \n   degrees of freedom:  2 \n   p-value:  0.005 \n\nOther information: \n   estimated effect size (Cramer's v):  0.244 \n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nMaybe we want to keep it traditional and use `chisq.test()` will there be a difference?\n\n[Book Ch 12.6 - The most typical way to do a chi-square test in R](https://learningstatisticswithr.com/book/chisquare.html#chisq.test)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi <- chisq.test(table(chapek9$choice, chapek9$species))\nchi\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  table(chapek9$choice, chapek9$species)\nX-squared = 10.722, df = 2, p-value = 0.004697\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nBut what if we want to visualize it? Use `sjPlot` again\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_xtab(chapek9$choice, \n          chapek9$species)\n```\n\n::: {.cell-output-display}\n![](06_OneSample2_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nLet's clean that up a little bit more\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_xtab(chapek9$choice, chapek9$species, margin = \"row\", bar.pos = \"stack\", coord.flip = TRUE)\n```\n\n::: {.cell-output-display}\n![](06_OneSample2_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Writing it up\n\n> Pearson's $\\chi^2$ revealed a significant association between species and choice ( $\\chi^2 (2) =$ 10.7, $p$ \\< .01), such that robots appeared to be more likely to say that they prefer flowers, but the humans were more likely to say they prefer data.\n\n------------------------------------------------------------------------\n\n## Assumptions of the test\n\n-   The expected frequencies are rather large\n\n-   Data are independent of one another\n\n------------------------------------------------------------------------\n\n## Comparing Means\n\nWhen we move from categorical outcomes to variables measured on an interval or ratio scale, we become interested in means rather than frequencies. Comparing means is usually done with the *t*-test, of which there are several forms.\n\nThe one-sample *t*-test is appropriate when a single sample mean is compared to a population mean but the population standard deviation is unknown. A sample estimate of the population standard deviation is used instead. The appropriate sampling distribution is the t-distribution, with N-1 degrees of freedom.\n\n$$t_{df=N-1} = \\frac{\\bar{X}-\\mu}{\\frac{\\hat{\\sigma}}{\\sqrt{N}}}$$\n\nThe heavier tails of the t-distribution, especially for small N, are the penalty we pay for having to estimate the population standard deviation from the sample.\n\n------------------------------------------------------------------------\n\n## One-sample *t*-tests\n\n*t*-tests were developed by William Sealy Gosset, who was a chemist studying the grains used in making beer. (He worked for Guinness.)\n\n-   Specifically, he wanted to know whether particular strains of grain made better or worse beer than the standard.\n\n-   He developed the *t*-test, to test small samples of beer against a population with an unknown standard deviation.\n\n    -   Probably had input from Karl Pearson and Ronald Fisher\n\n-   Published this as \"Student\" because Guinness didn't want these tests tied to the production of beer.\n\n------------------------------------------------------------------------\n\n### Load in the dataset from last class\n\n\n::: {.cell}\n\n```{.r .cell-code}\nschool <- read_csv(\"https://raw.githubusercontent.com/dharaden/dharaden.github.io/main/courses/PSYC640_fall23/data/example2-chisq.csv\") %>% \n  mutate(Score_in_memory_game = as.numeric(Score_in_memory_game))\nschool <- school %>% \n  filter(!is.na(Score_in_memory_game))\n```\n:::\n\n\n------------------------------------------------------------------------\n\n### One-sample *t*-tests vs Z-test\n\n|                                             | Z-test                    | *t*-test                        |\n|-------------------|---------------------------|---------------------------|\n| $\\large{\\mu}$                               | known                     | known                           |\n| $\\sigma$                                    | known                     | unknown                         |\n| sem or $\\sigma_M$                           | $\\frac{\\sigma}{\\sqrt{N}}$ | $\\frac{\\hat{\\sigma}}{\\sqrt{N}}$ |\n| Probability distribution                    | standard normal           | $t$                             |\n| DF                                          | none                      | $N-1$                           |\n| Tails                                       | One or two                | One or two                      |\n| Critical value $(\\alpha = .05, two-tailed)$ | 1.96                      | Depends on DF                   |\n\n------------------------------------------------------------------------\n\n### **Assumptions of the one-sample *t*-test**\n\n**Normality.** We assume the sampling distribution of the mean is normally distributed. Under what two conditions can we be assured that this is true?\n\n**Independence.** Observations in the dataset are not associated with one another. Put another way, collecting a score from Participant A doesn't tell me anything about what Participant B will say. How can we be safe in this assumption?\n\n------------------------------------------------------------------------\n\n### A brief example\n\nUsing the same Census at School data, we find that New York students who participated in a memory game ( $N = 224$ ) completed the game in an average time of 44.2 seconds ( $s = 15.3$ ). We know that the average US student completed the game in 45.04 seconds. How do our students compare?\n\n**Hypotheses**\n\n$H_0: \\mu = 45.05$\n\n$H_1: \\mu \\neq 45.05$\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n$$\\mu = 45.05$$\n\n$$N = 227$$\n\n$$ \\bar{X} = 44.2 $$\n\n$$ s = 15.3 $$\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(x = school$Score_in_memory_game, \n       mu = 45.05,\n       alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  school$Score_in_memory_game\nt = -0.86545, df = 223, p-value = 0.3877\nalternative hypothesis: true mean is not equal to 45.05\n95 percent confidence interval:\n 42.14729 46.18116\nsample estimates:\nmean of x \n 44.16422 \n```\n:::\n:::\n\n:::\n:::\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsr::oneSampleTTest(x = school$Score_in_memory_game,\n                    mu = 45.05, one.sided = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   One sample t-test \n\nData variable:   school$Score_in_memory_game \n\nDescriptive statistics: \n            Score_in_memory_game\n   mean                   44.164\n   std dev.               15.318\n\nHypotheses: \n   null:        population mean equals 45.05 \n   alternative: population mean not equal to 45.05 \n\nTest results: \n   t-statistic:  -0.865 \n   degrees of freedom:  223 \n   p-value:  0.388 \n\nOther information: \n   two-sided 95% confidence interval:  [42.147, 46.181] \n   estimated effect size (Cohen's d):  0.058 \n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Cohen's D\n\nCohen suggested one of the most common effect size estimates---the standardized mean difference---useful when comparing a group mean to a population mean or two group means to each other.\n\n$$\\delta = \\frac{\\mu_1 - \\mu_0}{\\sigma} \\approx d = \\frac{\\bar{X}-\\mu}{\\hat{\\sigma}}$$\n\nCohen's d is in the standard deviation (Z) metric.\n\n------------------------------------------------------------------------\n\nCohens's d for these data is .05. In other words, the sample mean differs from the population mean by .05 standard deviation units.\n\nCohen (1988) suggests the following guidelines for interpreting the size of d:\n\n::: nonincremental\n-   .2 = Small\n\n-   .5 = Medium\n\n-   .8 = Large\n:::\n\n[Cohen, J. (1988), Statistical power analysis for the behavioral sciences (2nd Ed.). Hillsdale: Lawrence Erlbaum.]{style=\"font-size:30px;\"}\n\n------------------------------------------------------------------------\n\n### The usefulness of the one-sample *t*-test\n\nHow often will you conducted a one-sample *t*-test on raw data?\n\n-   (Probably) never\n\nHow often will you come across one-sample *t*-tests?\n\n-   (Probably) a lot!\n\nThe one-sample *t*-test is used to test coefficients in a model.\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Load sleep data: https://vincentarelbundock.github.io/Rdatasets/datasets.html\nsleep <- read_csv(\"https://raw.githubusercontent.com/dharaden/dharaden.github.io/main/courses/PSYC640_fall23/data/sleepstudy.csv\")\nmodel = lm(Reaction ~ Days, data = sleep)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Reaction ~ Days, data = sleep)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-110.848  -27.483    1.546   26.142  139.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  251.405      6.610  38.033  < 2e-16 ***\nDays          10.467      1.238   8.454 9.89e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 47.71 on 178 degrees of freedom\nMultiple R-squared:  0.2865,\tAdjusted R-squared:  0.2825 \nF-statistic: 71.46 on 1 and 178 DF,  p-value: 9.894e-15\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Next time...\n\nMore comparing means!\n\n# Reminders\n\nNo Class 10/9\n\nNo Office Hours tomorrow (10/5)\n\nNext lab will likely begin on 10/16\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}