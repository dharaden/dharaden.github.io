quarto(render)
#| code-fold: true
days <- factor(c("M", "T", "W", "R", "F"),
levels = ("M", "T", "W", "R", "F"))
# Chunk 1
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
# Chunk 2
library(here)
library(tidyverse)
library(psych)
library(psychTools)
library(knitr)
library(kableExtra)
library(ggpubr)
library(gganimate)
library(patchwork)
#| code-fold: true
days <- c("M", "T", "W", "R", "F")
customers <- rep(50, length(days))
df <- data.frame(days, customers)
order <- c("M", "T", "W", "R", "F")
unif <- df %>%
ggplot(aes(x = days,
y = customers)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Uniform - Null") +
ylim(0, 65)
customers2 <- rnorm(5, mean = 55, sd = 4)
df2 <- data.frame(days, customers2)
rand <- df %>%
ggplot(aes(x = days,
y = customers2)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Alternative") +
ylim(0, 65)
(unif + rand)
#| code-fold: true
ggplot(data.frame(x = c(0, 20)), aes(x = x)) +
stat_function(fun = dchisq, args = list(df = 4))
#| code-fold: true
ggplot(data.frame(x = c(0, 20)), aes(x = x)) +
stat_function(fun = dchisq, args = list(df = 4)) +
labs(title = "Chi-Square Distribution (df = 4)")
(critical_val = qchisq(p = 0.95, df = 5-1))
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = 5-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = 5-1), geom = "area", fill = "purple",
xlim =c(critical_val, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "purple")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, 5-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
#| code-fold: true
days <- c("M", "T", "W", "R", "F")
customers <- rep(50, length(days))
df <- data.frame(days, customers)
order <- c("M", "T", "W", "R", "F")
unif <- df %>%
ggplot(aes(x = days,
y = customers)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Uniform - Null") +
ylim(0, 65)
customers2 <- rnorm(5, mean = 55, sd = 4)
df2 <- data.frame(days, customers2)
rand <- df %>%
ggplot(aes(x = days,
y = customers2)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Alternative") +
ylim(0, 65)
(unif + rand)
#| code-fold: true
days <- c("M", "T", "W", "R", "F")
expected <- rep(50, length(days))
df <- data.frame(days, expected)
order <- c("M", "T", "W", "R", "F")
unif <- df %>%
ggplot(aes(x = days,
y = expected)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Uniform - Null") +
ylim(0, 65)
observed <- rnorm(5, mean = 55, sd = 4)
df2 <- data.frame(days, observed)
rand <- df %>%
ggplot(aes(x = days,
y = observed)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Alternative") +
ylim(0, 65)
(unif + rand)
observed <- table(df2$observed)
observed
observed <- table(df2)
observed
observed <- df2
observed
glimpse(observed)
head(observed)
#| code-fold: true
days <- c("M", "T", "W", "R", "F")
expected <- rep(50, length(days))
df <- data.frame(days, expected)
order <- c("M", "T", "W", "R", "F")
unif <- df %>%
ggplot(aes(x = days,
y = expected)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Uniform - Null") +
ylim(0, 65)
observed <- round(rnorm(5, mean = 55, sd = 4),2)
df2 <- data.frame(days, observed)
rand <- df %>%
ggplot(aes(x = days,
y = observed)) +
geom_col() +
scale_x_discrete(limits = order) +
labs(title = "Alternative") +
ylim(0, 65)
(unif + rand)
observed <- df2
head(observed)
print(observed)
observed - expected
observed <- df2[]
observed
observed <- as.list(df2)
observed
table(observed[1])
table(observed[2])
table(observed[1,2])
table(observed[.,2])
observed <- as.list(df2[2])
observed
expected <- as.list(df[1])
expected
observed <- as.list(df2[2])
observed
expected <- as.list(df[2])
expected
observed - expected
observed <- as.list(df2[2])
observed
expected <- as.list(df[2])
expected
observed - expected
observed <- df2
observed
observed <- df2
expected <- df
r expected[2,1]
expected[2,1]
r expected[1,1]
expected[1,1]
View(df)
expected[1,2]
expected[2,1]
expected[1]
expected[1,1]
expected[2,1]
expected[1,2]
expected[1,3]
expected[2,2]
expected[3,2]
chisq_tab <- full_join(expected, observed)
View(chisq_tab)
chisq_tab <- full_join(expected, observed) %>%
mutate(diff = (observed - expected))
# Chunk 1
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
# Chunk 2
library(here)
library(tidyverse)
library(psych)
library(psychTools)
library(knitr)
library(kableExtra)
library(ggpubr)
library(gganimate)
library(patchwork)
# Chunk 3
days <- c("M", "T", "W", "R", "F")
customers <- rep(50, length(days))
df <- data.frame(days, customers)
unif <- df %>%
ggplot(aes(x = days,
y = customers)) +
geom_col() +
labs(title = "Uniform - Null") +
ylim(0, 65)
customers2 <- rnorm(5, mean = 55, sd = 4)
df2 <- data.frame(days, customers2)
rand <- df %>%
ggplot(aes(x = days,
y = customers2)) +
geom_col() +
labs(title = "Alternative") +
ylim(0, 65)
(unif + rand)
# Chunk 4
school = read_csv("https://raw.githubusercontent.com/uopsych/psy611/master/data/census_at_school.csv")
school = school %>% filter(!is.na(Superpower))
# Chunk 5: frequency table
#| code-fold: true
school %>%
group_by(Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Proportion = Frequency/sum(Frequency)) %>%
kable(.,
format = "html",
digits = 2) %>%
kable_classic(font_size = 25)
# Chunk 6
#| code-fold: true
school_usa = read_csv("https://raw.githubusercontent.com/uopsych/psy611/master/data/census_at_school_usa.csv")
school_usa$Region = "USA"
school %>%
full_join(select(school_usa, Region, Superpower)) %>%
filter(!is.na(Superpower)) %>%
group_by(Region, Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Proportion = Frequency/sum(Frequency)) %>%
ggplot(aes(x = Region, y = Proportion, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
coord_flip() +
labs(
x = NULL,
title = "Category Proportion as a \nfunction of Source") +
guides(fill = "none") +
facet_wrap(~Superpower) +
theme_bw(base_size = 20) +
theme(plot.title.position = "plot")
# Chunk 7
#| code-fold: true
school %>%
full_join(select(school_usa, Region, Superpower)) %>%
mutate(Region = ifelse(Region == "OR", "OR", "USA")) %>%
filter(!is.na(Superpower)) %>%
group_by(Region, Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Proportion = Frequency/sum(Frequency)) %>%
select(-Frequency) %>%
spread(Region, Proportion) %>%
kable(.,
col.names = c("Superpower", "OR Observed\nProportion",
"USA\nProportion"),
format = "html",
digits = 2)%>%
kable_classic(font_size = 25)
# Chunk 8
(critical_val = qchisq(p = 0.95, df = 5-1))
# Chunk 9
#| code-fold: true
#|
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = 5-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = 5-1), geom = "area", fill = "purple",
xlim =c(critical_val, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "purple")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, 5-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
# Chunk 10
usa_freq = table(school_usa$Superpower)
usa_prop = usa_freq/sum(usa_freq)
school %>%
filter(!is.na(Superpower)) %>%
group_by(Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Expected = usa_prop*200,
Expected = round(Expected, 2)) %>%
kable(., format = "html", digits = 2, align = c("l", "c", "c"),
col.names = c("Superpower", "Observed\nFreq", "Expected Freq"))
# Chunk 11: create obs
or_observed = table(school$Superpower)
or_expected = (table(school_usa$Superpower)/sum(table(school_usa$Superpower)))*200
or_observed
or_expected
# Chunk 12
# Chunk 13
(chi_square = sum((or_observed - or_expected)^2/or_expected))
# Chunk 14
# Chunk 15
(chi_square = sum((or_observed - or_expected)^2/or_expected))
(critical_val = qchisq(p = 0.95, df = length(or_expected)-1))
# Chunk 16
(chi_square = sum((or_observed - or_expected)^2/or_expected))
(critical_val = qchisq(p = 0.95, df = length(or_expected)-1))
(p_val = pchisq(q = chi_square, df = length(or_expected)-1, lower.tail = F))
#| code-fold: true
#|
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = length(or_expected)-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = length(or_expected)-1), geom = "area", fill = "purple",
xlim =c(critical_val, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "purple")+
geom_vline(aes(xintercept = chi_square), linetype = 2, color = "black")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, length(or_expected)-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
geom_text(aes(x = chi_square+2, y = dchisq(critical_val, length(or_expected)-1) + .05,
label = paste("Test statistic =", round (chi_square,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
#|code-fold: true
chisq_tab <- full_join(expected, observed) %>%
mutate(diff = (observed - expected)) %>%
kable(., format = "html", digits = 2,
align = c("l", "l", "c","c", "c", "c", "c"))
full_join(expected, observed) %>%
mutate(diff = (observed - expected)) %>%
kable(., format = "html", digits = 2)
#| code-fold: true
chisq_tab <- chisq_tab %>%
mutate(sq_diff=(diff^2)) %>%
mutate(error = sq_diff/50)
#| code-fold: true
chisq_tab <- full_join(expected, observed) %>%
mutate(diff = (observed - expected))
#| code-fold: true
chisq_tab <- chisq_tab %>%
mutate(sq_diff=(diff^2)) %>%
mutate(error = sq_diff/50)
length(chisq_tab$days)-1
qchisq(p = 0.95, df = length(chisq_tab$days)-1)
#| code-fold: true
#|
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "area", fill = "purple",
xlim =c(critical_val, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "purple")+
geom_vline(aes(xintercept = chi_square), linetype = 2, color = "black")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
geom_text(aes(x = chi_square+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Test statistic =", round (chi_square,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
critical_val <- qchisq(p = 0.95, df = length(chisq_tab$days)-1)
critical_val
chi_square <- sum(chisq_tab$error)
chi_square
#| code-fold: true
#|
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "area", fill = "purple",
xlim =c(critical_val, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "purple")+
geom_vline(aes(xintercept = chi_square), linetype = 2, color = "black")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
geom_text(aes(x = chi_square+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Test statistic =", round (chi_square,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
#| code-fold: true
#|
data.frame(x = seq(0,20)) %>%
ggplot(aes(x = x)) +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "line") +
stat_function(fun = function(x) dchisq(x, df = length(chisq_tab$days)-1), geom = "area", fill = "purple",
xlim =c(chi_square, 20)) +
geom_vline(aes(xintercept = critical_val), linetype = 2, color = "black")+
geom_vline(aes(xintercept = chi_square), linetype = 2, color = "purple")+
geom_text(aes(x = critical_val+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Critical Value =", round (critical_val,2))), angle = 90)+
geom_text(aes(x = chi_square+2, y = dchisq(critical_val, length(chisq_tab$days)-1) + .05,
label = paste("Test statistic =", round (chi_square,2))), angle = 90)+
labs(x = "Chi-Square", y = "Density", title = "Area under the curve") +
theme_pubr(base_size = 20)
school <- read_csv("https://raw.githubusercontent.com/dharaden/dharaden.github.io/main/data/example2-chisq.csv") %>%
filter(!is.na(Superpower))
#| code-fold: true
school %>%
group_by(Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Proportion = Frequency/sum(Frequency)) %>%
kable(.,
format = "html",
digits = 2) %>%
kable_classic(font_size = 25)
#| code-fold: true
school_usa <-  read_csv("https://raw.githubusercontent.com/uopsych/psy611/master/data/census_at_school_usa.csv")
school_usa$Region = "USA"
school %>%
full_join(select(school_usa, Region, Superpower)) %>%
filter(!is.na(Superpower)) %>%
group_by(Region, Superpower) %>%
summarize(Frequency = n()) %>%
mutate(Proportion = Frequency/sum(Frequency)) %>%
ggplot(aes(x = Region, y = Proportion, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
coord_flip() +
labs(
x = NULL,
title = "Category Proportion as a \nfunction of Source") +
guides(fill = "none") +
facet_wrap(~Superpower) +
theme_bw(base_size = 20) +
theme(plot.title.position = "plot")
View(observed)
observed
observed[1,2]
